
# 要件定義書（改訂版）
本日検査品 不具合分析ダッシュボード自動生成スクリプト

## 1. 概要

### 1.1. 目的
指定された2つの Access データベースから、本日検査対象ロットの不具合データを抽出し、
不良率および不具合内容を集計・分析する。
また、41期ワースト品番および対象品番の過去3年分データについても同様に集計し、
SaaS風デザインの HTML ダッシュボードとして出力する。

### 1.2. 想定利用者
- 品質検査課
- 品質保証課
- 部門管理者、経営層

### 1.3. 開発環境
| 項目 | 内容 |
|---|---|
| 言語 | Python 3.x |
| ライブラリ | pyodbc / pandas / jinja2 |
| DB | Microsoft Access（.accdb）2種 |
| 出力形式 | HTML |

## 2. 対象データ（改訂）

### 2.1. 使用する Access データベース

#### ① 外観検査集計データベース
- パス: `\\192.168.1.200\共有\品質保証課\外観検査記録\外観検査記録照会.accdb`
- テーブル: t_外観検査集計

#### ② 不具合情報データベース
- パス: `\\192.168.1.200\共有\品質保証課\外観検査記録\不具合情報記録.accdb`
- テーブル: t_不具合情報

## 3. 機能要件（改訂）

### 3.1. 本日検査品データ抽出
- 本日ロット抽出
- 生産ロットIDを一意化
- 不具合情報DB とロットIDで一致行を抽出

### 3.2. 本日不具合集計
- 品番別集計（数量・総不具合数・不良率）
- 外観キズ〜その他内容の不具合区分を集計

### 3.4. 過去3年集計
- ロット抽出→不具合情報JOIN
- 月次／四半期で集計
- 自動コメント生成

## 4. HTML出力仕様（SaaS風）
- ARAI ロゴ
- ブルー基調のグラデーションヘッダ
- 本日サマリー・一覧表
- ワースト品番分析・過去3年サマリ

## 5. 入出力
### 入力
- 実行日、自動取得
- 2つの Access DB

### 出力
- defect_dashboard_YYYY-MM-DD.html

## 6. 非機能要件
- 実行速度 1〜2分以内
- ログ出力
- 設定ファイル外部化
